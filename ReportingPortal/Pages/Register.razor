@page "/register"
@using Models.front

@inject NavigationManager Navigation
@inject HttpClient HttpClient
@inject AuthService authService

<div>
    <RegisterForm OnRegister="HandleRegister" />
</div>

@code {

    private async Task HandleRegister(RegisterFormModel model)
    {
        Console.WriteLine($"Email: {model.Email}, Password: {model.Password}");

        RegisterRequest request = new RegisterRequest
        {
            Email = model.Email,
            Password = model.Password,
            ConfirmPassword = model.ConfirmPassword,
            Name = model.Name,
            Surname = model.Surname,
        };

        try
        {
            RegisterResponse response = await authService.RegisterAsync(request);

            if (response.StatusCode >= 200 && response.StatusCode <= 299)
            {
                Console.WriteLine("Registration successful!");

                Navigation.NavigateTo("/login");
            }
            else
            {
                Console.WriteLine($"Registration failed: {response.Message} (Status: {response.StatusCode})");
            }
        }
        catch (Exception ex)
        {
            Console.WriteLine($"Unexpected error: {ex.Message}");
        }
    }

}
